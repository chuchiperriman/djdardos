{% extends "dardos/base.html" %}

{% load dardos_general %}

{% block title %}Jugadores{% endblock %}

{% block content %}

<link type="text/css" href="/site_media/css/ui/jquery.ui.all.css" rel="stylesheet" />
<script type="text/javascript" src="/site_media/js/jquery-1.4.2.js"></script>
<script type="text/javascript" src="/site_media/js/ui/jquery.ui.core.js"></script>
<script type="text/javascript" src="/site_media/js/ui/jquery.ui.widget.js"></script>
<script type="text/javascript" src="/site_media/js/ui/jquery.ui.tabs.js"></script>
<script type="text/javascript">
	$(function() {
		$("#tabs").tabs();
	});
	
	function show_jornada(url){
	    $.get(url, function(data) {
	        $('#partidos_jornada').html(data);
        });
    }
	
</script>


<h1>{{ jugador.nombre }}</h1>
<div id="ficha">
    <div id="foto">
    {% if jugador.path_foto %}
        <img src="/site_media/fotos/jugadores/{{jugador.path_foto}}"/>
    {% else %}
        <img src="/site_media/fotos/jugadores/nofoto.jpg"/>
    {% endif %}
    </div>
    <div id="datos">
        <b>Nombre:</b> {{jugador.nombre}}<br/>
        <b>Equipo:</b> <a href="/equipos/{{jugador.equipo.id}}">{{jugador.equipo.nombre}}</a><br/>
        <b>Fecha de alta:</b> {{jugador.fecha_alta}}<br/>
        <b>E-Mail:</b> 
        {% if jugador.email %}
            <a href="mailto:{{jugador.email}}">{{jugador.email}}</a><br/>
        {% endif %}
    </div>
</div>

<div id="tabs" style="clear:both">
	<ul>
		<li><a href="#tabs-1">Estadística</a></li>
		<li><a href="#tabs-2">P. Individuales</a></li>
		<li><a href="#tabs-3">P. Parejas</a></li>
		<li><a href="#tabs-4">Gráficas</a></li>
	</ul>
	<div id="tabs-1">
	    {% show_estadisticas_jugador jugador%}
	</div>
	<div id="tabs-2">
	    <table>
	        <tr>
	            <th>Fecha</th>
	            <th>Local</th>
	            <th>Ganador</th>
	            <th>Visitante</th>
	            <th>&nbsp;</th>
	        </tr>
	    {% for partida in jugador.jugador_local.all %}
	        {% include "dardos/jugadores/partida_ind_row.html" %}
	    {% endfor %}
	    {% for partida in jugador.jugador_visitante.all %}
	        {% include "dardos/jugadores/partida_ind_row.html" %}
	    {% endfor %}
	    </table>
    </div>
    <div id="tabs-3">
        <table>
	        <tr>
	            <th>Fecha</th>
	            <th>Locales</th>
	            <th>Ganadores</th>
	            <th>Visitantes</th>
	            <th>&nbsp;</th>
	        </tr>
	    {% for partida in jugador.jugador_local1.all %}
	        {% include "dardos/jugadores/partida_par_row.html" %}
	    {% endfor %}
	    {% for partida in jugador.jugador_local2.all %}
	        {% include "dardos/jugadores/partida_par_row.html" %}
	    {% endfor %}
	    {% for partida in jugador.jugador_visitante1.all %}
	        {% include "dardos/jugadores/partida_par_row.html" %}
	    {% endfor %}
	    {% for partida in jugador.jugador_visitante2.all %}
	        {% include "dardos/jugadores/partida_par_row.html" %}
	    {% endfor %}
	    
	    </table>
    </div>
    <div id="tabs-4">
        <div id="chart_" style="height:400px;width:500px; "></div>
        <script language="javascript">
            line1=[
                {% for j in jornadas %}
                    {% if j.partido.jugado %}
                        {% ifequal j.partido.equipo_local.id equipo.id %}
                            [{{j.jornada.numero}},{{j.partido.puntos_local}}],
                        {% else %}
                            [{{j.jornada.numero}},{{j.partido.puntos_visitante}}],
                        {% endifequal %}
                    {% endif %}
                {% endfor%}
                ];
            line2=[
                {% for j in jornadas %}
                    {% if j.partido.jugado %}
                        {% ifnotequal j.partido.equipo_local.id equipo.id %}
                            [{{j.jornada.numero}},{{j.partido.puntos_local}}],
                        {% else %}
                            [{{j.jornada.numero}},{{j.partido.puntos_visitante}}],
                        {% endifnotequal %}
                    {% endif %}
                {% endfor%}
            ];
            xticks = [0,1,2,3,4,5,6,7,8,9,10];
            yticks = [0, 2, 4, 6, 8, 10, 12, 14, 16];
            plot4 = $.jqplot('chartdiv', [line1, line2], {
                legend:{show:true}, 
                title:'Evolución de partidas ganadas/perdidas',
                grid: {background:'#f3f3f3', gridLineColor:'#accf9b'},
                series:[
                    {label:'Ganadas'}, 
                    {label:'Perdidas'}
                ],
                axes:{
                    xaxis:{ticks:xticks}, 
                    yaxis:{ticks:yticks, tickOptions:{formatString:'%d'}}
                }
            });
        </script>
    </div>
</div>
{% endblock %}


